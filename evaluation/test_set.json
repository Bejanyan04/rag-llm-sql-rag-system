[
  {"question": "List all clients with their industries.", "expected_sql": "SELECT client_id, client_name, industry FROM Clients;"},
  {"question": "Which clients are based in the UK?", "expected_sql": "SELECT * FROM Clients WHERE country = 'UK';"},
  {"question": "List all invoices issued in March 2024 with their statuses.", "expected_sql": "SELECT invoice_id, status FROM Invoices WHERE strftime('%Y-%m', invoice_date) = '2024-03';"},
  {"question": "Which invoices are currently marked as \"Overdue\"?", "expected_sql": "SELECT * FROM Invoices WHERE status = 'Overdue' OR (due_date < date('now') AND status != 'Paid');"},
  {"question": "For each service_name in InvoiceLineItems, how many line items are there?", "expected_sql": "SELECT service_name, COUNT(*) AS line_item_count FROM InvoiceLineItems GROUP BY service_name;"},
  {"question": "List all invoices for Acme Corp with their invoice IDs, invoice dates, due dates, and statuses.", "expected_sql": "SELECT Invoices.invoice_id, Invoices.invoice_date, Invoices.due_date, Invoices.status FROM Invoices JOIN Clients ON Invoices.client_id = Clients.client_id WHERE Clients.client_name = 'Acme Corp';"},
  {"question": "Show all invoices issued to Bright Legal in February 2024, including their status and currency.", "expected_sql": "SELECT Invoices.invoice_id, Invoices.invoice_date, Invoices.due_date, Invoices.status, Invoices.currency FROM Invoices JOIN Clients ON Invoices.client_id = Clients.client_id WHERE Clients.client_name = 'Bright Legal' AND strftime('%Y-%m', Invoices.invoice_date) = '2024-02';"},
  {"question": "For invoice I1001, list all line items with service name, quantity, unit price, tax rate, and compute the line total (including tax) for each.", "expected_sql": "SELECT service_name, quantity, unit_price, tax_rate, quantity * unit_price * (1 + tax_rate) AS line_total FROM InvoiceLineItems WHERE invoice_id = 'I1001';"},
  {"question": "For each client, compute the total amount billed in 2024 (including tax) across all their invoices.", "expected_sql": "SELECT Clients.client_id, Clients.client_name, SUM(InvoiceLineItems.quantity * InvoiceLineItems.unit_price * (1 + InvoiceLineItems.tax_rate)) AS total_billed FROM Clients JOIN Invoices ON Clients.client_id = Invoices.client_id JOIN InvoiceLineItems ON Invoices.invoice_id = InvoiceLineItems.invoice_id WHERE strftime('%Y', Invoices.invoice_date) = '2024' GROUP BY Clients.client_id, Clients.client_name;"},
  {"question": "Which client has the highest total billed amount in 2024, and what is that total?", "expected_sql": "SELECT Clients.client_name, SUM(InvoiceLineItems.quantity * InvoiceLineItems.unit_price * (1 + InvoiceLineItems.tax_rate)) AS total_billed FROM Clients JOIN Invoices ON Clients.client_id = Invoices.client_id JOIN InvoiceLineItems ON Invoices.invoice_id = InvoiceLineItems.invoice_id WHERE strftime('%Y', Invoices.invoice_date) = '2024' GROUP BY Clients.client_id, Clients.client_name ORDER BY total_billed DESC LIMIT 1;"},
  {"question": "Across all clients, which three services generated the most revenue in 2024? Show the total revenue per service.", "expected_sql": "SELECT InvoiceLineItems.service_name, SUM(InvoiceLineItems.quantity * InvoiceLineItems.unit_price * (1 + InvoiceLineItems.tax_rate)) AS total_revenue FROM InvoiceLineItems JOIN Invoices ON InvoiceLineItems.invoice_id = Invoices.invoice_id WHERE strftime('%Y', Invoices.invoice_date) = '2024' GROUP BY InvoiceLineItems.service_name ORDER BY total_revenue DESC LIMIT 3;"},
  {"question": "Which invoices are overdue as of 2024-12-31? List invoice ID, client name, invoice_date, due_date, and status.", "expected_sql": "SELECT Invoices.invoice_id, Clients.client_name, Invoices.invoice_date, Invoices.due_date, Invoices.status FROM Invoices JOIN Clients ON Invoices.client_id = Clients.client_id WHERE Invoices.due_date < '2024-12-31' AND Invoices.status != 'Paid';"},
  {"question": "Group revenue by client country: for each country, compute the total billed amount in 2024 (including tax).", "expected_sql": "SELECT Clients.country, SUM(InvoiceLineItems.quantity * InvoiceLineItems.unit_price * (1 + InvoiceLineItems.tax_rate)) AS total_billed FROM Clients JOIN Invoices ON Clients.client_id = Invoices.client_id JOIN InvoiceLineItems ON Invoices.invoice_id = InvoiceLineItems.invoice_id WHERE strftime('%Y', Invoices.invoice_date) = '2024' GROUP BY Clients.country;"},
  {"question": "For the service \"Contract Review\", list all clients who purchased it and the total amount they paid for that service (including tax).", "expected_sql": "SELECT Clients.client_name, SUM(InvoiceLineItems.quantity * InvoiceLineItems.unit_price * (1 + InvoiceLineItems.tax_rate)) AS total_paid FROM Clients JOIN Invoices ON Clients.client_id = Invoices.client_id JOIN InvoiceLineItems ON Invoices.invoice_id = InvoiceLineItems.invoice_id WHERE InvoiceLineItems.service_name = 'Contract Review' GROUP BY Clients.client_id, Clients.client_name;"},
  {"question": "Considering only European clients, what are the top 3 services by total revenue (including tax) in H2 2024 (2024-07-01 to 2024-12-31)?", "expected_sql": "SELECT InvoiceLineItems.service_name, SUM(InvoiceLineItems.quantity * InvoiceLineItems.unit_price * (1 + InvoiceLineItems.tax_rate)) AS total_revenue FROM InvoiceLineItems JOIN Invoices ON InvoiceLineItems.invoice_id = Invoices.invoice_id JOIN Clients ON Invoices.client_id = Clients.client_id WHERE Clients.country IN ('UK', 'Germany', 'France', 'Spain', 'Italy', 'Netherlands', 'Belgium', 'Portugal', 'Poland', 'Sweden', 'Austria', 'Ireland', 'Denmark', 'Finland', 'Greece', 'Romania', 'Czech Republic', 'Czechia', 'Hungary', 'Switzerland', 'Norway') AND Invoices.invoice_date BETWEEN '2024-07-01' AND '2024-12-31' GROUP BY InvoiceLineItems.service_name ORDER BY total_revenue DESC LIMIT 3;"}
]
